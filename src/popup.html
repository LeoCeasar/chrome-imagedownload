<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Image Downloader</title>
    <link rel="stylesheet" href="popup.css">
  </head>
  <body>
    <header>
      <h1>Image Downloader</h1>
    </header>

    <section class="controls">
      <div class="format">
        <label><input type="radio" name="format" value="original" checked> 保留原格式</label>
        <label><input type="radio" name="format" value="jpeg"> 转换为 JPEG</label>
        <span class="quality" id="qualityRow" hidden>
          质量: <input type="range" id="quality" min="0.1" max="1" step="0.05" value="0.92"> <span id="qualityVal">0.92</span>
        </span>
      </div>
      <div class="thumb-fit">
        缩略图适配：
        <select id="fitMode">
          <option value="contain" selected>完整显示</option>
          <option value="cover">裁剪填充</option>
        </select>
      </div>
      <div class="thumb-fit">
        预览设置：
        <label><input type="checkbox" id="previewEnabled" checked> 启用悬浮预览</label>
        <span style="margin-left:8px;">大小：</span>
        <select id="previewSize">
          <option value="sm">小</option>
          <option value="md" selected>中</option>
          <option value="lg">大</option>
        </select>
        <span style="margin-left:8px;">延迟(ms)：</span>
        <input id="previewDelay" type="number" min="0" max="2000" step="50" value="200" style="width:80px;" />
        <label style="margin-left:8px;"><input type="checkbox" id="previewSticky"> 点击固定预览</label>
      </div>
      <div class="filters">
        <label>域筛选：<input id="filterDomain" placeholder="包含的域或子串" /></label>
        <label>搜索：<input id="filterQuery" placeholder="按文件名/URL 过滤" /></label>
      </div>
      <div class="actions">
        <button id="refreshBtn">扫描</button>
        <button id="selectAllBtn">全选</button>
        <button id="clearBtn">清空</button>
        <button id="downloadBtn" class="primary">下载所选</button>
        <button id="openSidebarBtn" title="在侧边栏中打开">打开侧边栏</button>
      </div>
      <div id="payBar" class="pay-bar" hidden>
        <span id="quotaText">免费额度：今日剩余 0 张</span>
        <span class="spacer"></span>
        <button id="buyBtn" title="解锁无限下载">解锁</button>
        <button id="refreshLicenseBtn" title="我已购买，刷新授权">刷新授权</button>
      </div>
    </section>

    <section class="list">
      <div id="status" class="status">正在扫描...</div>
      <ul id="imageList" class="image-list"></ul>
    </section>

    <footer>
      <small>在当前标签页扫描图片资源</small>
    </footer>

    <!-- Optional: vendor extpay js if available -->
    <script src="extpay.js"></script>
    <script src="pay.js"></script>
    <script src="popup.js"></script>
  </body>
  </html>
