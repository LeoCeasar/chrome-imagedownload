# 项目进度（plan.md）

## 阶段与状态
- [x] 搭建 MV3 扩展基础结构（manifest、目录）
- [x] 内容脚本：扫描页面图片（img/src、srcset、懒加载、CSS 背景）
- [x] 弹窗 UI：列表展示、选择、全选/清空、扫描按钮
- [x] 下载实现：
  - [x] 保留原格式下载
  - [x] JPEG 转换（可调质量）、下载
- [x] 侧边栏：注册 Side Panel、侧边栏 UI
- [x] 实时更新：内容脚本 MutationObserver + Port 推送
- [x] 文档完善：README 与 plan.md（更新侧边栏说明）

## 后续改进想法（Backlog）
- [ ] 过滤/排序：按尺寸、类型、域名过滤或排序图片。
- [ ] 预览增强：悬浮显示原图尺寸、大小（如能获取）。
- [ ] 批量命名：自定义命名模板（例如：`{title}-{index}.{ext}`）。
- [ ] 性能优化：海量图片时虚拟列表渲染与按需缩略图。
- [ ] 记忆设置：使用 `chrome.storage` 记忆上次格式与画质。
- [ ] 错误提示：在下载失败时，给出更清晰的错误反馈与重试机制。

## 进度更新日志
- 2025-11-29
  - 初始化扩展：MV3 manifest、内容脚本图片扫描、弹窗 UI。
  - 实现下载：原格式下载与 JPEG 转换（画质可调）。
  - 新增侧边栏：注册 Side Panel，构建侧边栏 UI。
  - 实时更新：内容脚本使用 MutationObserver + Port 推送媒体（图片/视频）到侧边栏。
  - 弹窗入口：增加“打开侧边栏”按钮。
  - 文档：完善 README 与 plan.md。
- 2025-11-29
  - 缩略图增强：默认完整显示（contain），并提供“完整显示/裁剪填充”切换。
  - 悬浮预览：鼠标悬浮显示大图/视频预览，不影响交互（pointer-events: none）。
  - 尺寸显示：在缩略图上叠加原始宽×高角标（图片与视频分别在 load/loadedmetadata 后显示）。
- 2025-11-29
  - 预览配置：新增开关与大小（小/中/大）选择，应用于弹窗和侧边栏。
  - 偏好持久化：使用 chrome.storage.local 记忆适配模式、预览开关与预览大小。
  - 预览信息：在预览框中尝试显示 Content-Type 与大小（通过 HEAD 请求）。
- 2025-11-29
  - 预览增强：新增“预览延迟”与“点击固定预览”。
  - 过滤与搜索：侧边栏支持类型/域/关键字过滤；弹窗支持域/关键字过滤。
